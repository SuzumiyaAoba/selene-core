/// Dispatch built-in procedure by name.
pub fn apply_builtin(name : String, args : Array[Value]) -> Result[Value, EvalError] {
  match name {
    "+" => builtin_add(args)
    "-" => builtin_sub(args)
    "*" => builtin_mul(args)
    "/" => builtin_div(args)
    "quotient" => builtin_quotient(args)
    "remainder" => builtin_remainder(args)
    "modulo" => builtin_modulo(args)
    "abs" => builtin_abs(args)
    "max" => builtin_max(args)
    "min" => builtin_min(args)
    "cons" => builtin_cons(args)
    "car" => builtin_car(args)
    "cdr" => builtin_cdr(args)
    "set-car!" => builtin_set_car(args)
    "set-cdr!" => builtin_set_cdr(args)
    "caar" => builtin_caar(args)
    "cadr" => builtin_cadr(args)
    "cdar" => builtin_cdar(args)
    "cddr" => builtin_cddr(args)
    "caaar" => builtin_caaar(args)
    "caadr" => builtin_caadr(args)
    "cadar" => builtin_cadar(args)
    "caddr" => builtin_caddr(args)
    "cdaar" => builtin_cdaar(args)
    "cdadr" => builtin_cdadr(args)
    "cddar" => builtin_cddar(args)
    "cdddr" => builtin_cdddr(args)
    "pair?" => builtin_pair_p(args)
    "number?" => builtin_number_p(args)
    "integer?" => builtin_integer_p(args)
    "real?" => builtin_real_p(args)
    "boolean?" => builtin_boolean_p(args)
    "symbol?" => builtin_symbol_p(args)
    "null?" => builtin_null_p(args)
    "procedure?" => builtin_procedure_p(args)
    "list?" => builtin_list_p(args)
    "zero?" => builtin_zero_p(args)
    "positive?" => builtin_positive_p(args)
    "negative?" => builtin_negative_p(args)
    "odd?" => builtin_odd_p(args)
    "even?" => builtin_even_p(args)
    "=" => builtin_num_eq(args)
    "<" => builtin_lt(args)
    ">" => builtin_gt(args)
    "<=" => builtin_le(args)
    ">=" => builtin_ge(args)
    "eq?" => builtin_eq_p(args)
    "eqv?" => builtin_eqv_p(args)
    "equal?" => builtin_equal_p(args)
    "not" => builtin_not(args)
    "apply" => builtin_apply(args)
    "map" => builtin_map(args)
    "for-each" => builtin_for_each(args)
    "filter" => builtin_filter(args)
    "fold-left" => builtin_fold_left(args)
    "fold-right" => builtin_fold_right(args)
    "list" => builtin_list(args)
    "length" => builtin_length(args)
    "append" => builtin_append(args)
    "reverse" => builtin_reverse(args)
    "list-ref" => builtin_list_ref(args)
    "list-tail" => builtin_list_tail(args)
    "assq" => builtin_assq(args)
    "assv" => builtin_assv(args)
    "assoc" => builtin_assoc(args)
    "memq" => builtin_memq(args)
    "memv" => builtin_memv(args)
    "member" => builtin_member(args)
    "symbol->string" => builtin_symbol_to_string(args)
    "string->symbol" => builtin_string_to_symbol(args)
    "string?" => builtin_string_p(args)
    "char?" => builtin_char_p(args)
    "char=?" => builtin_char_eq(args)
    "char<?" => builtin_char_lt(args)
    "char>?" => builtin_char_gt(args)
    "char<=?" => builtin_char_le(args)
    "char>=?" => builtin_char_ge(args)
    "char-alphabetic?" => builtin_char_alphabetic_p(args)
    "char-numeric?" => builtin_char_numeric_p(args)
    "char-whitespace?" => builtin_char_whitespace_p(args)
    "char-upper-case?" => builtin_char_upper_case_p(args)
    "char-lower-case?" => builtin_char_lower_case_p(args)
    "char-upcase" => builtin_char_upcase(args)
    "char-downcase" => builtin_char_downcase(args)
    "char->integer" => builtin_char_to_integer(args)
    "integer->char" => builtin_integer_to_char(args)
    "string->list" => builtin_string_to_list(args)
    "list->string" => builtin_list_to_string(args)
    "gcd" => builtin_gcd(args)
    "lcm" => builtin_lcm(args)
    "string-length" => builtin_string_length(args)
    "string-ref" => builtin_string_ref(args)
    "string-append" => builtin_string_append(args)
    "string=?" => builtin_string_eq(args)
    "string<?" => builtin_string_lt(args)
    "string>?" => builtin_string_gt(args)
    "string<=?" => builtin_string_le(args)
    "string>=?" => builtin_string_ge(args)
    "string-ci=?" => builtin_string_ci_eq(args)
    "string-ci<?" => builtin_string_ci_lt(args)
    "string-ci>?" => builtin_string_ci_gt(args)
    "string-ci<=?" => builtin_string_ci_le(args)
    "string-ci>=?" => builtin_string_ci_ge(args)
    "make-string" => builtin_make_string(args)
    "substring" => builtin_substring(args)
    "string-copy" => builtin_string_copy(args)
    "string-set!" => builtin_string_set(args)
    "string-fill!" => builtin_string_fill(args)
    "vector?" => builtin_vector_p(args)
    "make-vector" => builtin_make_vector(args)
    "vector" => builtin_vector(args)
    "vector-length" => builtin_vector_length(args)
    "vector-ref" => builtin_vector_ref(args)
    "vector-set!" => builtin_vector_set(args)
    "vector-fill!" => builtin_vector_fill(args)
    "vector->list" => builtin_vector_to_list(args)
    "list->vector" => builtin_list_to_vector(args)
    "floor" => builtin_floor(args)
    "ceiling" => builtin_ceiling(args)
    "truncate" => builtin_truncate(args)
    "round" => builtin_round(args)
    "sqrt" => builtin_sqrt(args)
    "expt" => builtin_expt(args)
    "exact?" => builtin_exact_p(args)
    "inexact?" => builtin_inexact_p(args)
    "number->string" => builtin_number_to_string(args)
    "sin" => builtin_sin(args)
    "cos" => builtin_cos(args)
    "tan" => builtin_tan(args)
    "asin" => builtin_asin(args)
    "acos" => builtin_acos(args)
    "atan" => builtin_atan(args)
    "exp" => builtin_exp(args)
    "log" => builtin_log(args)
    "display" => builtin_display(args)
    "newline" => builtin_newline(args)
    "write" => builtin_write(args)
    "read" => builtin_read(args)
    "string->number" => builtin_string_to_number(args)
    "call/cc" | "call-with-current-continuation" => builtin_call_cc(args)
    "force" => builtin_force(args)
    "promise?" => builtin_promise_p(args)
    "values" => builtin_values(args)
    "call-with-values" => builtin_call_with_values(args)
    "dynamic-wind" => builtin_dynamic_wind(args)
    // Complex number related
    "make-rectangular" => builtin_make_rectangular(args)
    "make-polar" => builtin_make_polar(args)
    "real-part" => builtin_real_part(args)
    "imag-part" => builtin_imag_part(args)
    "magnitude" => builtin_magnitude(args)
    "angle" => builtin_angle(args)
    "complex?" => builtin_complex_p(args)
    // Rational number related
    "numerator" => builtin_numerator(args)
    "denominator" => builtin_denominator(args)
    "rational?" => builtin_rational_p(args)
    // port operation
    "input-port?" => builtin_input_port_p(args)
    "output-port?" => builtin_output_port_p(args)
    "port?" => builtin_port_p(args)
    "open-input-file" => builtin_open_input_file(args)
    "open-output-file" => builtin_open_output_file(args)
    "close-input-port" => builtin_close_input_port(args)
    "close-output-port" => builtin_close_output_port(args)
    "read-char" => builtin_read_char(args)
    "peek-char" => builtin_peek_char(args)
    "eof-object?" => builtin_eof_object_p(args)
    "write-char" => builtin_write_char_port(args)
    "eval" => Err(EvalError::InvalidSyntax("eval: can only be used in VM context"))
    _ => Err(EvalError::InvalidSyntax("unknown builtin: " + name))
  }
}
